<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NUNF: Matrix Condition Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NUNF<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">Generalized neutron unfolding library for cpp</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('matrix_condition_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Matrix Condition Example</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To begin please go to the root of the package if you are not already. Now open the file ./examples/EJ301D_Conform_Binning_Condition_Ratios/EJ301D_Conform_Binning_Condition_Ratios.C </p><pre class="fragment"> vim ./examples/EJ301D_Conform_Binning_Condition_Ratios/EJ301D_Conform_Binning_Condition_Ratios.C
</pre><p> We refer the reader to the comments. This page will walk the user through the code, making references to labeled code block numbers.<br  />
The way matrix condition comparison works is that a user passes in a single response matrix to the program. Various copies of the matrix are made and each copy is given various modifications, such as rebinning in the x axis, rebinning in the y, and modification to the size. All matrices are made to be square based on a size parameter as well. If the number of rows and columns after rebinning are less than the size parameter an error occurs.</p>
<h2>Code Block 1: Setting the filereader</h2>
<pre class="fragment">    //creates fileio object to read in the response matrix
    UNFOLD::FILEIO *fio;
    fio = new UNFOLD::FILEIO();
</pre><p>This block of code is used for creating the fileio object. The object will read in the response matrix and do data manipulations for the condition comparion.</p>
<h2>Code Block 2: Reading in the base response matrix.</h2>
<pre class="fragment">    //Code Block 2
    //sets the response matrix using a text file.
    fio-&gt;setResponse("./EJ301D_Conform_Binning_Condition_Ratios/EJ301D_To55MeV_0.02LoAnd0.02NEnMeV.txt",0,0,0,0.02,0.0025);
</pre><p>This block of code reads in a text file for the matrix. For condition comparison, only one matrix is read in and multiple copies, each one with various modifications, are created. The parameters are as follows: <br  />
</p><ul>
<li>The path to the file</li>
<li>Whether or not the file has neutron energy bins as its rows (1) or columns (0)</li>
<li>The start value for the neutron energy bin edge in MeV</li>
<li>The start value for the light output bin edge in MeVee</li>
<li>The neutron energy bin width in MeV</li>
<li>The light output bin width in MeVee. <br  />
 <h2>Code Block 3: Setting the conformal bin parameters</h2>
</li>
</ul>
<pre class="fragment">    //Code Block 3
    //sets the parameters for the conformal binning to compare conformal binning to plain old rebinned matrices
    float p0 = 572.0/1000.;
    float p1 = 2394.0/1000.;
    float p2 = 200.0/1000.;
    float fraction = 1.0;
</pre><p>This set of code sets the parameters for conformal binning, which is used to compare the results with fixed interval rebinned matrices. The variables p0, p1, p2, and fraction represent specific values used in the conformal binning process. These parameters get utilized in code block 6.</p>
<h2>Code Block 4: Setting parameters for matrix copies</h2>
<pre class="fragment">    //Code Block 4 
    //Each element in the following vectors corresponds to a parameter for modifying a copy of the current response matrix.
    //In this case, the condition ratios of 4 different response matrices will be compared. 
    //The first response matrix is the 0th element of all the vectors.
    //The params are as follows. 
    std::vector&lt;int&gt; rebin_factor_per_row={8,16,40,1};
    std::vector&lt;int&gt; rebin_factor_per_col={1,2,5,5};
    std::vector&lt;const char *&gt; plot_names={"0.02 E_{n} MeV and 0.02 Lo MeVee Bins","0.04 E_{n} MeV and 0.04 Lo MeVee Bins","0.1 E_{n} MeV and 0.1 Lo MeVee Bins","0.1 E_{n} MeV and Conformed Lo MeVee Bins"};
    std::vector &lt;int&gt; marker_numbers={2,3,5,21};
    //use p0's pointer
</pre><p>This block of code defines vectors with different parameters for modifying copies of the response matrix. This enables the comparison of condition ratios for different response matrices. Each element in the vectors corresponds to the parameters in a specific index of vectors. As such, each vector is required to have the same number of elements as all other vectors.</p>
<h2>Code Block 5: Calling the plotting function</h2>
<pre class="fragment">    //Code Block 5 
    //Note that the parameter 3 indicates which parameter is using conformal binning. If the parameter is not an index or negative, or p1, p2,p3,or fraction are null, then the program will not perform conformal binning on the matrix in any index.
    //If wanting to do conformal binning on one of the matrix copies, note that the rebinning factors will be applied before the conformal binning.
    fio-&gt;plotConditionRatios(rebin_factor_per_row,rebin_factor_per_col,plot_names,marker_numbers,300,3,&amp;p0,&amp;p1,&amp;p2,&amp;fraction);
</pre><p>In code block 5, the plotConditionRatios function is called to generate plots of the condition ratios. The parameters passed to the function are as follows:<br  />
</p><ul>
<li>rebin_factor_per_row: A vector of integers that represent the rebinning factor for each row of the response matrix. The rebinning factor is the number of bins that are combined into one bin. For example, a rebinning factor of 2 means that two bins are combined into one bin. The rebinning factor is applied to the response matrix before the conformal binning is applied. See last bullet point.</li>
<li>rebin_factor_per_col: A vector of integers that represent the rebinning factor for each column of the response matrix. The rebinning factor is the number of bins that are combined into one bin. For example, a rebinning factor of 2 means that two bins are combined into one bin. The rebinning factor is applied to the response matrix before the conformal binning is applied. See last bullet point.</li>
<li>plot_names: A vector of strings that represent the names of the plots. Each element in the vector corresponds to a plot. The number of elements in the vector must be the same as the number of elements in the rebin_factor_per_row and rebin_factor_per_col vectors.</li>
<li>marker_numbers: A vector of integers that represent the marker numbers for the plots. Each element in the vector corresponds to a plot. The number of elements in the vector must be the same as the number of elements in the rebin_factor_per_row and rebin_factor_per_col vectors.</li>
<li>Matrix size in bin counts: Matrices have the same singular value numbers as linearly independant columns. While matrix row size does not imply the number of linearly independant columns, we assume that each of the rebinned matrices have the same number of linearly independant columns as number of columns. As such, all matrices row and column count get pruned to this parameter. If after rebinning and conformal binning, the matrix has less rows or columns than this size parameter, an error is thrown. You must ensure that is not the case.</li>
<li>number_of_bins: An integer that represents the number of bins in the response matrix. This is used to determine the number of bins in the plots.</li>
<li>conformal_bin_parameters: An integer that represents the index of the parameter that will be using conformal binning. If the parameter is not an index or negative, or p1, p2,p3,or fraction are null, then the program will not perform conformal binning on the matrix in any index. If wanting to do conformal binning on one of the matrix copies, note that the rebinning factors will be applied before the conformal binning.</li>
</ul>
<h1><a class="anchor" id="running_the_program_1"></a>
Running the Program</h1>
<p>To run the example file that was described in this page, ./examples/EJ301D_Conform_Binning_Condition_Ratios/EJ301D_Conform_Binning_Condition_Ratios.C: <br  />
Please go to the root directory of the entire package<br  />
 From there change into the examples folder using </p><pre class="fragment">cd examples
</pre><p> Then run </p><pre class="fragment">bash kill_and_build.sh EJ301D_Conform_Binning_Condition_Ratios/EJ301D_Conform_Binning_Condition_Ratios.C
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Getting Started</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
